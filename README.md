# Citibike-Data-Cleaning

## Initiative
In this project, we seek to analyze Citi Bike’s System Data to understand the behavior of riders and gain insights into station placement choices. Citi Bike is the only bike-sharing system in New York City. With 12000 bikes on the road and over 800 stations in Manhattan, Brooklyn, and Queens, Citi Bike is a crucial part of the transportation system in New York City. Our analysis will not only help Citi Bike to understand New York users, but also guide the expansions of Citi Bike or other bike-sharing systems in different cities. Ultimately we aim to be able to provide Citi Bike (or a similar ride-sharing company or project) with recommendations on cities, but more specifically zip codes, that would be good opportunities to expand into. 



## Dataset
Citi Bike has posted its trip history data on the website https://www.citibikenyc.com/system-data since 2013. The data includes Trip Duration, Start Time and Date, Stop Time and Date, Start Station Name, End Station Name, Station ID, Station Lat/Long, Bike ID, User Type, Gender and Year of Birth. We quickly decided to focus on the 2018-2019 two years data for Manhattan and Jersey City for now since our model cannot handle such large datasets for now considering the computation time it requires to train the model. Due to the objective of our project, we finalized our columns to Start Station Name, End Station Name, Station Lat/Long, Gender and Year of Birth then utilized web geocoding skills to obtain all the zip codes for each station. Besides the Citi Bike data, we also found geographical and demographic data from Census Reporter, an online resource that aggregates population census data for public access. The data we used from this resource included: the age and sex distribution, the distribution of work transportation (how persons get to and from work), the distribution of school enrollment, race distribution, and some income data. All of this data was obtained for each zip code where we had Citi Bike data that we used.


## Approach

In thinking about this problem we worked off of the insight/assumption that the popularity of stations would largely be a function of the characteristics of the areas in which they were located. We decided to specify these “areas” as zip codes, due to the standardization of zip codes across the country. Also the availability of data at the zip code level was a big factor in our decision to focus on zip codes since it would have been difficult/impossible to find meaningful data that was more granular than zip code data. For example, finding the median income for a city block would neither be possible nor standardized across the country. 

In order to identify the zip codes which would be most suitable for potential expansion, we decided to use a KNN model based on the zip code characteristics described in the Dataset section. This approach seemed reasonable to us at first given the categorical nature of selecting a zip code and the continuous nature of much of our zip code characteristics. We planned to train this model using the zip codes and trip data within Manhattan, and then validate it with the Jersey City-data. Additionally, we wanted to train an OLS model to predict the number of trips that would be associated with the zip codes that we found most suitable for expansion.

Unfortunately, after building out the KNN model we realized that it heavily weighted very few zip codes and just returned stations that were not as popular but within the same most popular zip code. We thought this was not useful and did not provide a useful business insight, so we pivoted away from this model and decided to then focus on the issue of: “If you were to expand Citi Bike to a new city, and could only put two stations to start with, where would you put them?” We thought this would be useful because it would highlight the general “trip” within the city that we predicted to be the most popular. This would have a big impact on the popularity of a station, and the program overall. In order to answer this question, we chose all the combinations of 2 zip codes from the 58 in Manhattan that we were analyzing and derived which pair is projected to have the most trips between them. Our goal in taking this approach was to discern features between these zip codes that made them so popular.

## Data Cleaning

In order to obtain usable data, we had to engage in some data cleaning. This involved geocoding to obtain the zip codes of the individual bike stations. We then compiled these zip codes and used the Census Reporter resource to obtain zip code level data and characteristics to try to detect which features had predictive power in the popularity of stations (and therefore zip codes). We aggregated the station data within each zip code to analyze zip codes as a whole. 

Also, the Census Reporter data required some manipulation to suit our purposes. The data downloads from the website were only available as count values, which posed the problem of skewing the impact of various variables for zip codes with abnormally high populations, and zip codes with abnormally low populations. In order to correct this, we used proportion values in our models, which we obtained by simply taking the count values available and dividing by the relevant total, which was usually the total population for the zip code. This was the case for most distribution data within the zip codes, for example, race, age, or means of transportation.

The data we used came from multiple sources so after the data from each source was cleaned and aggregated where necessary, we exported the .csv data files to SQL, joined the data tables on zip code, and then exported the final table back to .csv. 


